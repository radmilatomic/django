# django

Django is a python web development framework, which means Django is a framework that allows you to build the websites using th python programming language and also html and css. Django is built for modern python, using 3.x and onward versions and also Django followes so called "batteries included" approach which is also what makes it a framework. This means that Django is a module that you install on your system which  exposes many functions and features you can use in your python code so you don't have to invent those features on your own. Django comes with many features, like handling incoming requests, parsing requests, working with form data, storing data in the database, authenticating user...<br>
Django is  also customisable and extensible, many aspects of django can be configured. Djanso is a production ready framework and it is being used for production websites out there.

```python
__init__.py
```
It only serves us to mark the folder as python module. This is not django exclusive concept

Create new django project:

```shell
django-admin startproject project_name
```
Pylance extension in VS code helps with code completion in python projects.

When creating a new project there is a subfolder created that carries our project name as a name. <br>
wsgi.py and asgi.py files are related to deployment<br>
settings.py file is there for us to configure this django project and we will come back to it often to add or change some settings. Although the default setting that are already defined can get us pretty far and we should leave those default setting as they are unless we have a good reason for changing something here.

urls.py file is important file which will control which routes / urls our websites supports later. We have to register all those different paths that we want to support.

## Apps

When building a django website you do that by adding and combining multiple so called Apps. Or multiple module or components. And this is a core feature of django. You split your own website into smaller packages, so called apps, which you can then combine together to build the overall website. So if we are building let's say an online shop, we can have one app (module) for the customer facing product pages, one app for the cart, one app for the customer administration area, one app for the customer backend pages the customer can see their past orders. You can split your django projects into granular, smaller parts, which are then easier to maintain and which you can possible share as python module between multiple projects

To create a new django app within a project, we run a command

```python
python manage.py startapp meetups
```

When we run this command, new folder called meetups is generated into this overall project folder. There, we see more files auto generated by Django and these are now files we will work in. 

views.py file is first important file - with help of views.py file and urls.py we will be able to register a url which we want to support on our page and then define what should happen if users enters that url.


How to run django server

```python
python3 manage.py runserver
```

Modules in django are called apps.

Apps, what are they? <br>
We can see them as features. Building blocks that form this overall project.

Example: Online shop is a project, apps are Producrs, Cart, Admin Area

https://github.com/academind/django-practical-guide-course-code/tree/setup-zz-extra-files

To create new django app, we run command

```shell
python3 manage.py startapp app_name
```

We have to make django be aware of newly created app by adding it to INSTALLED_APPS in global setting.py file

```python
INSTALLED_APPS = [
    'blog',
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
]
```

### URLs&Views

With views you can define what should happen when a certain url is entered in the browser. View in its simplest form is just a python function.

We have to addd urls.py file in each app folder.

Slug urls are SEO friendly because they describe a reached page in a way

When defining a slug url, django offers this buit in slug transformer.

```python
path("posts/<slug: slug>") # /posts/my-first-post
```
This does one main thing, it check if this concrete value which is passed when this path is reached has this slug format. Basically it means it's some text that contains characters and numbers and may contain dashes, but it doesn't contain any other special characters.

Functions that are triggered when this url is reached are called view functions and they are stored in views.py file.

In view functions request parametar is passed automatically by django, but we have to put it in function definition
```python
def starting_page(request):
    pass
```

Naming each path in url file is common practice, because we are going to nned does urls later in the code and it is better if we can reference them through their  name, so that the paths itself can change in the future in only one place

```python
urlpatterns=[
    path("", views.starting_page, name="starting-page"),
    path("posts", views.posts, name="posts-page"),
    path("posts/<slug: slug>", views.single_post, name="post-detail-page")
]
```

we have to wire up those urls in the project wide urls. We do that in urls.py from the project root. for that we need this include function which we include form django.urls.

```python
from django.contrib import admin
from django.urls import path, include

urlpatterns = [
    path('admin/', admin.site.urls),
    path("", include("blog.urls"))
]
```


### Templates

Templates allow us to predefine html files which we can then enrich with dynamic data with the help of our python code.<br>
we need to have templates folder inside our app folder since this is inbuilt django function, django will look for templates in folders with certain names. If we need extra directories with templates in it, we just need to add them in settings.py file in 'DIRS' array.<br>
Then in the templates folder we again create a folder with app name. This is done because django is merging all templates folder into one folder, behinfd the scene, so we need this subfolders in case we have same template names in different apps.

There is a django extension for VS code that can highlight django template language.<br>
we are adding templates folder in each app. In there it is best practise to repeat app folder name.<br>
We can also add a global templates folder for base templates - templates we want to use everywhere in the app, which the other templates will inherit.

We use block option in django template language to leave a place where any template can plug in into base template by leaving dedicated place for it

```html
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %} {% endblock %}</title>
    {% block css_files %} {% endblock %}
</head>
<body>
    {% block content %} {% endblock %}
</body>
</html>
```

We inherit the base html by adding extends tag. 

```html
{% extends  "base.html" %}

{% block title%}
    My blog
{% endblock %}

{% block content%}
    <h1>Welcome to my blog</h1>
{% endblock %}
```


If we are inheriting from global templates folder we have to tell django to evaluate this global templates folder.

In settings.py file we add, which construct django to consider this ase templates folder when it is looking form templates

```python
TEMPLATES=[
    {
        'DIRS':[
            BASE_DIR / "templates"
        ]
    }
]
```

Without this, this extends statement in html template would fail

(templates foders in app files are consider because django is aware of the all added apps, when we added them to INSTALLED_APPS list)

And finally this is how we instruct django to render a template for a certain view.<br>
Note that we are passing filepath realtive to templates folder, because django knows where to look for templates.

```python
def starting_page(request):
    return render(request, "blog/index.html")
```

Behind this render function django actually returns an HttpResponse object.

#### Static files

Files that don't change dynamically - like css files.

If we want to iclude them in our html we have to add a special dtla tag at the beginnig of html document. Tat enables static files in the template. Or better to say that enables the static files that is enabling us to generate the links to static files.
```python
{% load static %}
```
Then later we can use that static tag where we need a url to static file.

```html
<link rel="stylesheet" href="{% static "app.css"%}">
```

This global static folder isn't picked up by default by django. We have to go to setting.py and add following

```python
STATICFILES_DIRS=[
    BASE_DIR / "static"
]
```

If we want use html snippet in another html template, we use includes tag
```html
 {% include "blog/includes/post.html" %}
```

We can include links to other urls with url tag in django template language
```html
<h1><a href="{% url "starting-page"%}"> Rada's Blog</a></h1>
```
Name of the url, in this case "starting-page", is defined in urls.py

## 404 pages

If create a 404 template in base directory templates file, django will automatically call it if page is not found. We don't have to explicitley handle it in views

## Models
```python
Book.objects.get(id=1)
```
This is returning only one entry and throws an error if multiple entries found

```python
Book.objects.filter(is_bestselling=False)
```
This returns all the entries.

You don't always need to use equality

```python
Book.objects.filter(rating__lt=3)
```







